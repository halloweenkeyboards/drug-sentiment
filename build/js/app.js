!function(){"use strict";angular.module("app",["app.drugs"])}(),function(){"use strict";angular.module("app.drugs",[])}(),function(){"use strict";function t(t,e){function r(){console.log("screen resizd"),console.log("screen width: "+$(".drug-report").width()+" pixels")}t.title="the final report on drug experience sentiment",t.drugs=[],t.w=$(".container-fluid").width(),t.h=$(".container-fluid").height(),angular.element(document).ready(function(){t.getDrugs(),d3.select(window).on("resize",r)}),t.getDrugs=function(){e.get("/api/drugs").success(function(e){var r=50,n=[];_.each(e,function(t){t.experiences.length>=r&&n.push(t)}),t.drugs=n}).error(function(t){console.log("error :"+t)})},t.meetsMinimum=function(t){var e=50;return t.experiences.length>=e?!0:!1}}angular.module("app.drugs").controller("Drugs",t),t.$inject=["$scope","$http"]}(),function(){"use strict";angular.module("app.drugs").directive("drugList",function(){return{templateUrl:"app/widgets/drug-list.html",restrict:"E",controller:function(t){var e=25,r=d3.scale.linear().domain([-1,1]).range([0+e,t.w-e]);t.d3Options={pieRadius:150,pieW:1.5*t.w,pieH:335,padding:e,colorBuffer:55,colors:{designerDrug:"#19ffbe",plinky:"#ff195b"},newLineY:18,circleRadius:10,xScale:r,rgbScale:d3.scale.linear().domain([0,1]).range([255,0]),xAxis:d3.svg.axis().scale(r).orient("bottom").ticks(3)}}}})}(),function(){"use strict";angular.module("app.drugs").directive("drugReport",function(){return{templateUrl:"app/widgets/drug-report.html",restrict:"E",controller:function(t,e){t.w=$(".drug-report").width(),t.h=$(".drug-report").height(),t.drugRender=function(r){e(function(){{var e=[{label:"positive",value:r.positive},{label:"negative",value:100-r.positive}],n=d3.select(".drug-report#"+r.cssId+" svg"),i=n.append("g").attr("transform","translate("+t.d3Options.pieW/2+","+t.d3Options.pieH/2+")"),a=d3.svg.arc().outerRadius(t.d3Options.pieRadius),o=d3.layout.pie().value(function(t){return t.value});i.selectAll("path").data(o(e)).enter().append("path").attr("d",a).attr("fill",function(t){return"positive"===t.data.label?"blue":"red"})}n.append("text").attr("x",t.w/3*2).attr("y",6*t.d3Options.newLineY).attr("fill","white").text(r.positive+"% positive"),n.append("g").attr("class","axis").attr("transform","translate(0,"+(t.h-2*t.d3Options.padding)+")").call(t.d3Options.xAxis),n.append("text").attr("x",15).attr("y",2*t.d3Options.newLineY).attr("font-size",30).attr("textLength",function(){return t.w>=400?r.name.length<=5?t.w/5:r.name.length>5&&r.name.length<=12?t.w/5*2:t.w/2:t.w-t.d3Options.padding}).attr("fill",function(){return"DMT"===r.name?"black":"MDMA"===r.name?"#07566b":t.d3Options.colors.plinky}).attr("font-weight","bold").text(r.name),n.append("text").attr("x",15).attr("y",5*t.d3Options.newLineY).text(r.experiences.length+" experiences"),n.append("text").attr("x",15).attr("y",12*t.d3Options.newLineY).attr("font-size",90).attr("fill","white").text(r.average.toFixed(3));var s=n.selectAll("circle").data(r.experiences).enter().append("circle");s.attr("cx",function(e){return t.d3Options.xScale(e.score)}).attr("cy",t.h-2*t.d3Options.padding-2*t.d3Options.circleRadius).attr("r",t.d3Options.circleRadius).attr("fill",function(e){if(e.score>0){var r=t.d3Options.rgbScale(e.score);return d3.rgb(r,r-t.d3Options.colorBuffer,255)}if(e.score<0){var n=t.d3Options.rgbScale(Math.abs(e.score));return d3.rgb(255,n-t.d3Options.colorBuffer,n)}return"yellow"}).append("svg:title").text(function(t){return t.title+"\nsentiment: "+t.score+"\nexperience ID: "+t.number})},1e3)}}}})}(),angular.module("app").run(["$templateCache",function(t){t.put("app/widgets/drug-list.html",'<div ng-repeat="drug in drugs" class=drug-report ng-attr-id={{drug.cssId}} data-stellar-background-ratio=0.5><drug-report></drug-report></div>'),t.put("app/widgets/drug-report.html","<svg ng-attr-width={{w}} ng-attr-height={{h}} ng-init=drugRender(drug)></svg>")}]);